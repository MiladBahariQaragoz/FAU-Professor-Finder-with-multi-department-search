module.exports = [
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[project]/Documents/professorlist/web/app/api/scrape/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "POST",
    ()=>POST
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Documents/professorlist/web/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer__$5b$external$5d$__$28$puppeteer$2c$__esm_import$2c$__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$puppeteer$29$__ = __turbopack_context__.i("[externals]/puppeteer [external] (puppeteer, esm_import, [project]/Documents/professorlist/web/node_modules/puppeteer)");
var __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f40$ai$2d$sdk$2f$google$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Documents/professorlist/web/node_modules/@ai-sdk/google/dist/index.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f40$ai$2d$sdk$2f$openai$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Documents/professorlist/web/node_modules/@ai-sdk/openai/dist/index.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$ai$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/Documents/professorlist/web/node_modules/ai/dist/index.mjs [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__ = __turbopack_context__.i("[project]/Documents/professorlist/web/node_modules/zod/v3/external.js [app-route] (ecmascript) <export * as z>");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer__$5b$external$5d$__$28$puppeteer$2c$__esm_import$2c$__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$puppeteer$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer__$5b$external$5d$__$28$puppeteer$2c$__esm_import$2c$__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$puppeteer$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
;
;
;
;
;
;
// Map departments to their URL
const DEPARTMENT_URLS = {
    "Artificial Intelligence": "https://www.aibe.tf.fau.de/team/members/",
    "Chemical and Biological Engineering": "https://www.cbi.tf.fau.de/department/lehrstuehle-und-professuren/",
    "Electrical Engineering": "https://www.ee.tf.fau.de/department/lehrstuehle/",
    "Computer Science": "https://www.fau.de/department/informatik/lehrstuehle/",
    "Mechanical Engineering": "https://www.department.mb.tf.fau.de/department-maschinenbau/lehrstuehle-und-professuren/",
    "Materials Science": "https://www.mat.tf.fau.de/department/lehrstuehle/"
};
// Zod schema for the output
const ProfessorSchema = __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
    professors: __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].array(__TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        name: __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        department: __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        email: __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
        website: __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
        research_interests: __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].array(__TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()),
        bio_summary: __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
        relevance_score: __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].number().optional().describe("Score 0-10 based on user interests")
    }))
});
async function POST(req) {
    try {
        const { department, apiKey, provider, userInterests, ollamaModel } = await req.json();
        if (!department || !apiKey && provider !== "ollama") {
            return __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Missing required fields"
            }, {
                status: 400
            });
        }
        if (provider === "ollama" && !ollamaModel) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Ollama model must be selected"
            }, {
                status: 400
            });
        }
        const url = DEPARTMENT_URLS[department];
        if (!url) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Invalid department"
            }, {
                status: 400
            });
        }
        // 1. Scrape the website
        let content = "";
        try {
            const browser = await __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer__$5b$external$5d$__$28$puppeteer$2c$__esm_import$2c$__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$puppeteer$29$__["default"].launch({
                headless: true
            });
            const page = await browser.newPage();
            await page.setUserAgent("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36");
            await page.goto(url, {
                waitUntil: "networkidle2",
                timeout: 60000
            });
            content = await page.evaluate(()=>{
                const scripts = document.querySelectorAll('script, style, nav, footer, header');
                scripts.forEach((script)=>script.remove());
                return document.body.innerText;
            });
            // Truncate content if too long to avoid token limits (rough heuristic)
            if (content.length > 50000) content = content.substring(0, 50000);
            await browser.close();
        } catch (scrapeError) {
            console.error("Scraping failed:", scrapeError);
            return __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Failed to scrape content. The department website might be unreachable."
            }, {
                status: 502
            });
        }
        // 2. Process with LLM
        let model;
        if (provider === "gemini") {
            const google = (0, __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f40$ai$2d$sdk$2f$google$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createGoogleGenerativeAI"])({
                apiKey
            });
            model = google("models/gemini-1.5-flash-latest");
        } else if (provider === "groq") {
            const groq = (0, __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f40$ai$2d$sdk$2f$openai$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createOpenAI"])({
                baseURL: 'https://api.groq.com/openai/v1',
                apiKey
            });
            model = groq("llama-3.3-70b-versatile");
        } else if (provider === "ollama") {
            const ollama = (0, __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f40$ai$2d$sdk$2f$openai$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createOpenAI"])({
                baseURL: 'http://localhost:11434/v1',
                apiKey: 'ollama'
            });
            model = ollama(ollamaModel);
        } else {
            return __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Invalid provider"
            }, {
                status: 400
            });
        }
        const prompt = `
      You are an expert academic recruiter.
      Extract a list of professors from the following text scraped from a university department page.
      
      Department: ${department}
      URL: ${url}
      
      For each professor, extract:
      - Name
      - Specific Department/Chair (if mentioned)
      - Email (if available)
      - Website URL (if available)
      - Research Interests (as a list of 3-5 tags, e.g., "Deep Learning", "Robotics")
      - A brief 1-sentence bio summary based on the text.
      
      ${userInterests ? `
      CRITICAL: The user is looking for a supervisor with these interests: "${userInterests}".
      Rate each professor from 0-10 on relevance to these interests in the 'relevance_score' field.
      If the professor is highly relevant, ensure their research tags reflect that match.
      ` : `
      Set 'relevance_score' to 0 for all.
      `}

      Text Content:
      ${content}
    `;
        const result = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$ai$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["generateObject"])({
            model,
            schema: ProfessorSchema,
            prompt
        });
        return __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            professors: result.object.professors
        });
    } catch (error) {
        console.error("Processing error:", error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$Documents$2f$professorlist$2f$web$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: error.message || "Failed to process request"
        }, {
            status: 500
        });
    }
}
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__7b104e4f._.js.map